# ATTD

## ATTD란?

Acceptance test-driven development의 약자로 인수 테스트 주도 개발을 뜻한다.

## 인수 테스트란?

인수 테스트(Acceptance test)는 사용자의 스토리를 검증하는 기능 테스트로서 사용자 스토리로 테스트할 시나리오를 지정한다. 사용자 스토리를 인수 조건으로 정의하고 인수
조건을 검증한다.

> 인수 조건은 인수 테스트가 충족해야하는 조건을 말하며 가장 많이 사용하는 방법은 given-when-then 절로 이루어진
[scenario-oriented](http://antonymarcano.com/blog/2011/10/scenario-oriented-vs-rules-oriented-acceptance-criteria/)
> 이다.

## 인수 테스트의 장점

### 요구 사항을 가리키는 등대

개발을 하다보면 길을 잃는 경우가 생긴다. 무아지경으로 프로그래밍을 하다보면 결과물이 요구 사항에 맞지 않는 경우가
발생한다. 이러한 상황을 방지하고 명확한 요구 사항을 가리키는 등대 역할을 하는 것이 인수 테스트이다.

### 작업의 시작과 끝을 알리는 역할

요구 사항을 구현하다보면 어디서부터 시작해야할 지, 반대로 구현은 했는데 제대로 구현한 것인지 끝을 맺기가 애매하다. 이러한 고민을 인수 테스트로 해결할 수 있다.

하나의 요구 사항을 구현할 때 실패하는 인수 테스트를 만드는 것이 작업의 시작이 된다. 반대로 인수 테스트를 성공할 때 작업이 끝난다.

### 빠른 피드백

인수 테스트를 통해 구현한 기능이 잘 동작하는지 빠르게 알 수 있다. 정상 작동 여부를 알기 위해 애플리케이션을 배포하지 않아도 된다.

## How to do ATDD

### ATDD cycle

실패하는 인수 테스트를 만든 후 유닛 테스트 TDD를 수행하며 기능을 구현하고 최종적으로 인수 테스트를 성공시킨다.

### ATDD 우선 순위

비교적 짧고 빨리 끝나는 unhappy case를 먼저 작성해보자. 테스트 코드 특성상 이전에 작성한 코드와 유사한 형태를 띠는 경우가 많다.

### 구현 방법

인수 테스트는 요구 사항에 따라 구현 방법이 달라진다. 요구 사항에 따라 단위 테스트 혹은 통합 테스트가 인수 테스트가 될 수 있다.

### 유의 사항

인수 테스트는 API 접점에서 검증하는 E2E 테스트를 기반으로 이루어진다. 실제 요청과 응답 환경과 유사하게 테스트 환경을 구성하고 요청 정보와 응답 정보 이외 내부 정보는
최대한 가리는 Black box 형태로 이루어져야한다.

인수 테스트는 여러 상황을 전제로 하기 때문에 코드가 난해해질 수 있다. 이를 위해 given, when, then에서 자주 사용되는 로직은 메서드로 분리하고 메서드 이름에서
무엇을 하는지 명확하게 나타내는 것이 중요하다. 이때 메서드 이름을 한글로 지어 가독성을 더 높일 수 있다.

또, 테스트 클래스 내부에서 private 메서드로 사용할 수 있지만 해당 메서드가 다른 테스트 클래스에서도 사용 가능할 경우 Fixture class 혹은 Helper
class를 두어 static 메서드를 재사용하는 것도 좋은 방법이다.

## 단위 테스트와 비교

요구 사항은 크게 두 가지로 나눌 수 있다.

* 핵심 케이스
* 예외 케이스

인수 테스트에선 두 가지 경우를 고려하는 것보다 핵심 케이스 혹은 happy case만 고려하는 것이 좋다. 인수 테스트는 스토리를 준비하는 과정이 필요하기 때문에 테스트 시간이
오래 걸리기 때문이다.

따라서 예외 케이스의 경우 자주 빠르게 돌릴 수 있는 단위 테스트에서 검증하는 것이 좋다.

## 참고 자료

[NEXTSTEP for Enterprise 우아한테크캠프 6기](https://edu.nextstep.camp/c/DANlbea1/)
