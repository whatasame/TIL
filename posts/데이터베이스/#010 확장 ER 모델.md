# #010 확장 ER 모델

이번 글에서는 확장 ER 모델에 대해 알아보겠습니다.

## 확장 ER 모델이란?

확장 ER 모델(EER)이란 Enhanced ER, Extend ER로서 ER 모델의 모델링 개념에 추가적인 개념을 더한 것입니다. EER 모델에서 추가적으로 지원하는 개념들은 아래와 같습니다.

- 하위 클래스와 상위 클래스(Sub class and Super class)
- 특수화와 일반화(Specialization and Generalization)
- Union type
- 계승(Inheritance)

확장 ER 모델은 데이터베이스 응용을 개념적 모델로 나타낼 때 보다 정확하고 효과적으로 나타내기 위해 사용합니다.

## 하위 클래스와 상위 클래스

ER 모델에선 개체 간의 계층 구조가 없습니다. 그러나 개념적 모델을 만드는 데 있어 개체 간의 공통점과 차이점이 있고 이를 효과적으로 나타낼 필요가 생겼습니다. 예를 들어, 사원 개체에는 월급을 받는 사원과 시급을 받는 사원이 있는 것처럼 말이죠. 확장 ER 모델에서는 이를 하위 클래스와 상위 클래스로 나타냅니다.

위의 예처럼 사원의 봉급을 유형으로 나누면 아래와 같습니다.

<p align="center"><img src="../../images/데이터베이스/%23010%20%ED%99%95%EC%9E%A5%20ER%20%EB%AA%A8%EB%8D%B8/Untitled.png"></p>

- Employee/Salaried_Employee
- Employee/Hourly_Employee

### IS-A 관계

확장 ER 모델의 하위 클래스와 상위 클래스는 IS-A 관계를 형성합니다. IS-A 관계는 `~는 ~이다` 를 뜻하며 상속 관계에서 사용됩니다. 위의 예에선 `월급을 받는 사원은 사원이다`라는 IS-A 관계를 형성하고 있습니다.

IS-A 관계의 특징은 아래와 같습니다.

- 하위 클래스의 원소는 반드시 상위 클래스의 원소이다. (역은 성립하지 않음)
- 한 클래스에 다양한 종류의 하위 클래스들이 종유할 수 있다.
- 하위 클래스 개체는 **상위 클래스 개체의 속성과 관계를 모두 상속** 받는다.
    - 하위 클래스의 속성 = 상속받은 속성 + 지역 속성
    - 하위 클래스가 갖는 자신만의 속성을 지역 속성(Local attribute) 혹은 특수 속성(Specific attribute)라고 한다.
    - 키 속성
    - Overriding에 대한 처리

## 특수화와 일반화

이러한 상위 클래스와 하위 클래스를 정의할 때, 정의하는 방법을 2가지로 구분할 수 있습니다.

### 특수화(Specialization)

- 상위 클래스의 특수한 경우로 하위 클래스를 정의(Top-Down)
- 상위 클래스의 속성 값에 따라 특수화가 진행
- 하나의 상위 클래스에 대해 여러 개의 특수화가 가능
- 하위 클래스는 상위 클래스는 불가능한 자신만의 관계를 가질 수 있음

사원 클래스를 예로 들면 특수화는 아래와 같습니다.

- Employee - {Secretary, Engineer, Technician} → **Job type**에 따른 특수화
- Employee - {Manager} → **Role**에 따른 특수화
- Employee - {Salaried_Employee, Hourly_Employee} → **Pay type**에 따른 특수화

사원 클래스가 먼저 정의된 후 사원 클래스의 속성 값에 따라 특수화가 진행됩니다.

이처럼 특수화는 하나의 상위 클래스에 대해 여러가지 특수화가 가능합니다. 또한, 월급을 받는 사원이 노조 개체와 참여 관계를 갖는 것처럼 하위 클래스는 자신만의 관계를 가질 수 있습니다.

### 특수화의 종류

- 조건 기반 하위 클래스
- 속성 기반 특수화

### 일반화(Generalization)

- 하위 클래스의 공통된 점으로 상위 클래스를 정의(Bottom-Up)
- 하위 클래스의 공통 속성 값에 따라 일반화가 진행

승용차와 트럭 클래스를 예로 들면 일반화는 아래와 같습니다.

<p align="center"><img src="../../images/데이터베이스/%23010%20%ED%99%95%EC%9E%A5%20ER%20%EB%AA%A8%EB%8D%B8/Untitled%201.png"></p>

승용차와 트럭 클래스가 먼저 정의된 후 두 클래스의 공통 속성 값에 따라 일반화가 진행됩니다.

- 공통 속성 : Vehicle_id, License_plate_no, Price
- 지역 속성
    - CAR : Max_speed, No_of_passengers
    - TRUCK : No_of_axies, Tonnage

## 특수화와 일반화의 특징

### 구조

<p align="center"><img src="../../images/데이터베이스/%23010%20%ED%99%95%EC%9E%A5%20ER%20%EB%AA%A8%EB%8D%B8/Untitled%202.png"></p>

- 계층(Hierachy) : 하위 클래스가 하나의 상위 클래스만 갖는 트리 구조
- 격자(Lattice) : 여러 개의 상위 클래스가 존재하여 다중 상속을 지원하는 구조
    - 공유 하위 클래스(Shared subclass) : 하나 이상의 상위 클래스를 갖는 클래스

계층 구조를 설계할 때, 특수화를 통해 구조를 설계하면 특수화 계층이라 부르고, 일반화를 통해 구조를 설계하면 일반화 계층이라고 합니다. 이는 격자 구조를 설계할 때도 동일합니다.

### 제한 조건

- 서로소 조건(Disjoint constraint)
    - Disjoint(d)
    - Overlapping(o)
- 완전성 조건(Completeness constraint)
    - Total(=====)
    - Partial(———)

### Union type

승용차를 소유하는 관계를 생각해봅시다. 승용차를 소유하는 개체에는 개인 뿐만 아니라 은행, 법인 등 다양한 소유자 개체가 존재합니다. 만약 소유자 개체가 3개일 경우 동일한 소유 관계가 3개가 생깁니다. 또, 승용차가 아닌 다른 차가 있으면 어떻게 될까요? 승용차, 트럭, 버스와 개인, 은행, 법인 간의 소유 관계는 $3\times3=9$개가 발생할 것입니다. 승용차, 트럭, 버스 개체는 차라는 상위 클래스를 통해 IS-A 관계를 생성할 수 있습니다. 그러나, 공통점이 없는 개인, 은행, 법인 개체들은 공통점이 없기 때문에 IS-A 관계를 형성할 수 없습니다. 이를 해결하기 위해 나온 것이 Union type입니다.

<p align="center"><img src="../../images/데이터베이스/%23010%20%ED%99%95%EC%9E%A5%20ER%20%EB%AA%A8%EB%8D%B8/Untitled%203.png"></p>

Union type은 서로 다른 Entity type을 묶는 개념으로서 Category라고도 합니다. 여러 개의 상위 클래스를 갖는 다는 점은 Shared Subclass와 동일하지만 Shared Subclass는 모든 상위 클래스의 개체가 되는 반면, Union type 개체는 상위 클래스 중 하나의 상위 클래스에만 소속됩니다.

### 특수화와 일반화를 표현하는 방법

<p align="center"><img src="../../images/데이터베이스/%23010%20%ED%99%95%EC%9E%A5%20ER%20%EB%AA%A8%EB%8D%B8/Untitled%204.png"></p>

특수화와 일반화를 표현하는 방법에는 여러가지 방법이 있지만 이 글에서 사용하는 방법은 아래와 같습니다.

- 서로소 조건과 Union type은 원으로 표기한다.
- 완전성 조건은 상위 클래스와 원 사이의 선으로 표기한다.

### 특수화/일반화에 대한 설계 고려사항

- 개념적 설계 단계는 반복적인 정제 과정이므로 처음부터 완벽할 수가 없다. 1안, 2안, 3안, … 을 거쳐 다듬는 과정이 필요하다.
- 정제 과정에서 특수화를 지나치게 반복할 경우 클래스 수가 많아져 모델이 혼란스러워지므로 반드시 필요한 하위 클래스만 생성해야한다.
    
    하위 클래스가 지역 속성을 거의 가지지 않고 관계에도 참여하지 않는다면 상위 클래스와 합쳐야 한다.
    
    특수화를 통해 만들어진 하위 클래스는 상위 클래스의 속성에 나온 것이므로 합칠 때는 역으로 상위 클래스에 속성을 추가하여 합친다. 예를 들어, 사원 개체에서 특수화를 통해 만들어진 월급을 받는 사원, 시급을 받는 사원을 합치려고한다. 이 경우 사원 개체에 급여 방법이라는 속성을 두고 (월급, 시급)의 값을 갖도록 합치면 된다.
    
- Union Type은 관계형 모델 데이터베이스에서 지원하지 않는 경우가 많으므로 지양하고 가급적 특수화/일반화 등으로 대체하자.
- 서로소 조건과 완전성 조건은 응용 분야의 요구에 따라 결정하자. 특별한 요구 사항이 없으면 **Overlapping과 Partial을 기본 값**으로 하자.

## 확장 ER 모델 예제

ER 모델에서 배운 ER 모델 작성법과 확장 ER 모델의 개념을 활용하여 아래 예제의 EER 모델을 작성해 봅시다.

### 확장 ER 모델 작성 요령

1. 개체를 먼저 체크한다.
2. 일부, 특수와 같은 것은 Sub Class로 작성한다.
3. 동사는 관계로 작성되는 경우가 많다.
4. 개체의 속성을 정의한다.
5. N:N 관계를 정의한다.

### 예제 1

> 프로그래밍 개발 환경에서 프로그램과 사용자를 관리하는 데이터베이스를 구축하고자 한다. 이 환경에서 사용자는 프로그램을 사용하며, 로그인 이름으로 구별된다. 사용자의 이름과 소속, 그리고 전화번호 등의 정보도 추가로 관리되어야 한다. 사용자 중 일부는 프로그래머이다. 프로그래머는 여러 종류의 프로그래밍 언어를 사용하여 프로그램을 작성한다. 각 프로그램은 프로그램 이름과 확장자, 그리고 작성한 프로그래머의 로그인 이름으로 구별된다. 프로그램마다 버전 번호, 작성 날짜, 간단한 설명이 유지되어야 한다. 몇몇 프로그램은 데이터베이스를 활용하는데, 각 데이터베이스는 릴레이션 형태로 데이터를 저장한다. 이때 각각의 릴레이션은 여러 개의 애트리뷰트와 하나의 Primary Key를 가지고 있다. 각 데이터베이스는 데이터베이스 관리자에 의해 정의되는데, 데이터베이스 관리자는 특수한 프로그래머로 정의된다.
> 

### 예제 2

> 월드컵을 맞이하여 축구팀 및 축구 경기 정보를 저장하는 데이터베이스를 구축하고자 한다. 축구팀마다 이름과 소속 도시를 저장하여야 하며, 감독과 선수, 그리고 팬 등을 유지하여야 한다. 물론 감독과 선수는 한 팀에만 소속되며, 팀의 소속 선수의 수는 제한이 없지만, 감독은 팀별로 단 1명만 포함된다. 일반인은 팬으로서 축구팀에 소속될 수 있는데, 단 1팀에만 팬으로 등록될 수 있다. 감독 및 선수, 그리고 팬에 대해서는 이름과 주민등록번호를 저장하여야 한다. 각 팀은 다른 팀들과 경기하게 되는데, 각 경기에 대해 개최 날짜와 시간, 그리고 관중 수와 최종 점수를 유지하여야 한다. 각 경기가 개최된 경기장에 대해 경기장 이름과 위치, 그리고 수용 인원수를 유지하여야 하며, 축구팀별로 경기장에서 훈련한 날짜도 유지하여야 한다. 마지막으로 각 팬마다 경기를 관전한 내력도 유지하여야 한다.
>