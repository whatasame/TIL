# #010 시스템 호출

이번 글부터는 시스템 호출(System Call)을 활용하여 운영체제인 Linux를 제어하는 프로그램을 만들어 보도록 하겠습니다.

## 시스템 호출이란

시스템 호출은 커널에 서비스 요청을 위한 프로그래밍 인터페이스입니다. 우선, 커널과 인터페이스에 대해 간략하게 알아보도록 하겠습니다.

### 커널

- 운영체제의 핵심 구성 요소
- 하드웨어 자원(CPU, Memory, Storage, Etc.)을 운영하고 관리
- 하드웨어를 사용할 수 있도록 서비스를 제공

### 인터페이스

- 사용자가 상호 작용을 하는 곳
- 사용자로부터 내부 동작 과정을 숨김
- 내부 동작 과정을 몰라도 사용자가 쉽게 기능을 사용할 수 있도록 함

이러한 커널과 인터페이스를 안 채로 시스템 호출의 정의를 다시 보겠습니다. 시스템 호출은 커널에 서비스 요청을 위한 프로그래밍 인터페이스라고 하였습니다. 즉, Linux 운영체제가 어떻게 동작하는 지 몰라도 시스템 호출을 사용하면 하드웨어에 대한 서비스를 제공받을 수 있다는 것을 의미합니다.

다시 말해, 우리가 C, C++, Java와 같이 고급 언어로 작성한 응용 프로그램에서 시스템 호출을 사용하면 하드웨어를 제어할 수 있다는 뜻입니다.

<p align="center"><img src="../../images/시스템프로그래밍및보안/%23010%20%EC%8B%9C%EC%8A%A4%ED%85%9C%20%ED%98%B8%EC%B6%9C/Untitled.png"></p>

위 그림을 통해 시스템 호출의 사용을 알아보도록 하겠습니다. 응용 프로그램을 C 언어로 작성할 때 시스템 호출을 사용하는 방법은 두 가지로 구분할 수 있습니다.

- C 언어 라이브러리 함수를 통해 시스템 호출을 사용하는 경우
- C 언어에서 시스템 호출을 바로 사용하는 경우

C 언어 라이브러리 함수를 통해 시스템 호출을 사용하는 경우의 대표적인 예는 printf()입니다. 

```c
#include <stdio.h>
int printf(const char *format-string, argument-list);
```

`printf()`는 `stdio.h`라이브러리에 있는 함수로서 전달받은 매개 변수를 모니터에 출력합니다.C 언어로 작성한 응용 프로그램이 모니터라는 하드웨어를 제어한 것이죠.

그렇기 때문에 `printf()`는 모니터 제어에 해당하는 시스템 호출이 내부에 구현되어있습니다.

그렇다면 이제부터 C 언어에서 시스템 호출을 바로 사용하는 방법을 배워보겠습니다.

## 시스템 호출의 동작 과정

Linux에서 하드웨어를 제어하기 위해 자주 사용하는 시스템 호출은 아래와 같습니다.

<p align="center"><img src="../../images/시스템프로그래밍및보안/%23010%20%EC%8B%9C%EC%8A%A4%ED%85%9C%20%ED%98%B8%EC%B6%9C/Untitled%201.png"></p>

이것들 중에서 하드웨어를 제어하여 Storage에 저장된 파일을 여는 `open()`로 설명해보겠습니다.

<p align="center"><img src="../../images/시스템프로그래밍및보안/%23010%20%EC%8B%9C%EC%8A%A4%ED%85%9C%20%ED%98%B8%EC%B6%9C/Untitled%202.png"></p>

C로 작성한 응용 프로그램에서 `open()` 시스템 호출을 수행하면 C 런타임 라이브러리를 통해 커널에 있는 `open()` 코드로 이동합니다. 이후 `open()` 을 수행하고 실행 결과가 응용 프로그램으로 반환됩니다.

> **trap 명령어**는 UNIX 운영체제에서 비동기적인 사건을 전송하기 위해 사용하는 Signal 중에 하나입니다.
> 

> **비동기적인 사건**이란 언제 발생할 지 예측할 수 없는 사건으로서 터미널 종료, 메모리 침범, 알람, 장치로부터 입력 등의 사건이 이에 해당합니다. ([https://12bme.tistory.com/604](https://12bme.tistory.com/604))
> 

이러한 시스템 호출의 동작 과정을 인지한 상태로 다음 글부터 본격적으로 여러 가지 시스템 호출의 사용 방법을 알아보도록 하겠습니다.